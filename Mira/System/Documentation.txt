((documentation) get ("+b" write currentItem "Key" execute write "-b" write "    " write currentItem "Value" execute write endOfLine write) (currentItem) map) (help) set

(() ToArray String carriageReturn rotate 2 join Join) (joinItems) set
((template partName) put evaluateAndSplit join joinItems template "%" partName add "%" add rotate 2 join Replace) (expand) set

("<html>" "<body>" %document% "</body>" "</html>") (documentTemplate) set
("<h1>" "%name%" "</h1>" "<p>" "%brief%" "</p>" "<p>" "%in%" "→" "%out%" "</p>" "<b>" "Remark" "</b>" "<p>" %remark% "</p>" "<b>" "Category" "</b>" "<p>" %category% "</p>") (wordTemplate) set

((documentTemplate) get joinItems "document" expand) (documentNode) set
((wordTemplate) get joinItems swap evaluate) (wordNode) set
(swap "name" expand) (nameNode) set
(swap "brief" expand) (briefNode) set
(swap "in" expand) (inNode) set
(swap "out" expand) (outNode) set
(swap "remark" expand) (remarkNode) set
(swap "category" expand) (categoryNode) set

((index nodeName) put index "-" elementAtOrDefault 1 join nodeName toName) (makeNode) set

(
  (name) put
  name "#" documentation name "?" sortedListAtOrDefault add add
  splitParts (parts) put
  parts 0 "nameNode" makeNode
  parts 1 "briefNode" makeNode
  parts 2 "inNode" makeNode
  parts 3 "outNode" makeNode
  parts 4 "categoryNode" makeNode
  parts 5 "remarkNode" makeNode
  12 join
  "wordNode" toName 2 join
  "documentNode" toName 2 join
  evaluate
  display
)
(showDocumentation) set
